<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to tiler • tiler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to tiler">
<meta property="og:description" content="tiler">
<meta property="og:image" content="https://docs.ropensci.org/tiler/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tiler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tiler.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tiler-intro.html">Introduction to tiler</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leonawicz/tiler">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tiler-intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to tiler</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/tiler/blob/master/vignettes/tiler-intro.Rmd"><code>vignettes/tiler-intro.Rmd</code></a></small>
      <div class="hidden name"><code>tiler-intro.Rmd</code></div>

    </div>

    
    
<p>The <code>tiler</code> package provides a map tile-generator function for creating map tile sets for use with packages such as <code>leaflet</code>.</p>
<p>In addition to generating map tiles based on a common raster layer source, it also handles the non-geographic edge case, producing map tiles from arbitrary images. These map tiles, which have a “simple CRS”, a non-geographic simple Cartesian coordinate reference system, can also be used with <code>leaflet</code> when applying the simple CRS option. Map tiles can be created from an input file with any of the following extensions: <code>tif</code>, <code>grd</code> and <code>nc</code> for spatial maps and <code>png</code>, <code>jpg</code> and <code>bmp</code> for basic images.</p>
<div id="setup-windows-users" class="section level2">
<h2 class="hasAnchor">
<a href="#setup-windows-users" class="anchor"></a>Setup (Windows users)</h2>
<p>Python is required as well as the <code>gdal</code> library for Python. For Windows users, this is not the same as simply having <code>rgdal</code> installed through R. You need to install <code>gdal</code> so that it is accessible by Python. One of the easiest and typically recommended ways to do this in Windows is to install <a href="https://trac.osgeo.org/osgeo4w/">OSGeo4W</a>. It will bring all the required Python <code>gdal</code> library functionality along with it. OSGeo4W is also commonly installed along with <a href="https://qgis.org/en/site/forusers/download.html">QGIS</a>.</p>
<p>On Windows, <code>tiler_options</code> is set on package load with <code>osgeo4w = "OSgeo4W.bat"</code>. Make sure to add the path to this file to your system path variable. Otherwise it will not be found when calling <code>tile</code>. You can set the full path to <code>OSGeo4W.bat</code> directly in your R session with <code>tiler_options</code>. However, it is recommended to add the directory (e.g. <code>C:/OSGeo64</code> or wherever <code>OSGeo4W.bat</code> is located) to your system path so that you never had to deal with it in R.</p>
<p>Linux and Mac users should not have to do any additional setup as long as Python and <code>gdal</code> for Python are installed and available.</p>
</div>
<div id="geographic-map-tiles" class="section level2">
<h2 class="hasAnchor">
<a href="#geographic-map-tiles" class="anchor"></a>Geographic map tiles</h2>
<div id="context" class="section level3">
<h3 class="hasAnchor">
<a href="#context" class="anchor"></a>Context</h3>
<p>For the sake of simple, expedient examples, the map tiles generated below all use small zoom level ranges. There is also no reason to attempt displaying the tiles here. To make these examples more informative, each raster is loaded and plotted for context, though this is not necessary to the tiling process. Loading the <code>raster</code> package is only needed here for the print and plot calls.</p>
<p>The example maps packaged with <code>tiler</code> are not representative of large, high resolution imagery that benefits from tiling. These maps are very small in order to minimize package size and ensure examples run quickly. But the tiling procedures demonstrated are the same as would be applied to larger images.</p>
<p>Lastly, consider the power of your system before attempting to make a ton of tiles for large images at very high resolutions. You could find that the system could hang at any one of a number of choke points. If you are attempting to make thousands of tiles for a large, high resolution image and your system is struggling, it is recommended to (1) try making tiles for only one zoom level at a time, starting from zero and then increasing while monitoring your system resources. (2) If this is not enough, find a better system.</p>
</div>
<div id="basic-example" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-example" class="anchor"></a>Basic example</h3>
<p>Map tiles are generated with <code>tile</code>. <code>tile</code> takes an input file name <code>file</code> for the source map and a <code>tiles</code> destination path for where to save map tiles. The only other required argument is <code>zoom</code>, the range of zoom levels for the tiles. This is a string of the form, e.g. <code>3:7</code>. In this and the subsequent examples zoom levels 0-3 are used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tiler">tiler</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="va">tile_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tiles"</span><span class="op">)</span>
<span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"maps/map_wgs84.tif"</span>, package <span class="op">=</span> <span class="st">"tiler"</span><span class="op">)</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; class      : RasterLayer </span>
<span class="co">#&gt; dimensions : 32, 71, 2272  (nrow, ncol, ncell)</span>
<span class="co">#&gt; resolution : 0.8333333, 0.8333333  (x, y)</span>
<span class="co">#&gt; extent     : -125.0208, -65.85417, 23.27083, 49.9375  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 </span>
<span class="co">#&gt; source     : C:/github/tiler/inst/maps/map_wgs84.tif </span>
<span class="co">#&gt; names      : map_wgs84 </span>
<span class="co">#&gt; values     : -0.7205295, 5.545086  (min, max)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="vignette-ex1-1.png" alt=""><p class="caption">plot of chunk ex1</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">map</span>, <span class="va">tile_dir</span>, <span class="st">"0-3"</span><span class="op">)</span>
<span class="co">#&gt; Coloring raster...</span>
<span class="co">#&gt; Preparing for tiling...</span>
<span class="co">#&gt; [1] "C:\\Users\\Matt\\AppData\\Local\\Temp\\RtmpQLDRP8"</span>
<span class="co">#&gt; Creating tiles. Please wait...</span>
<span class="co">#&gt; Creating tile viewer...</span>
<span class="co">#&gt; Complete.</span>

<span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">tile_dir</span><span class="op">)</span>
<span class="co">#&gt; [1] "0"                   "1"                   "2"                   "3"                   "doc.kml"             "tilemapresource.xml"</span></code></pre></div>
<p>Listing the files in <code>tile_dir</code> shows the top level map tiles directories, 0-3 as expected. This is not printed in subsequent examples since it is not going to change.</p>
<p>Note that these examples rendered to HTML here do not capture the parts of the log output that result from the internal system call made by <code>tile</code>. When you run this example yourself you will see a bit more information at the console.</p>
</div>
<div id="projected-maps" class="section level3">
<h3 class="hasAnchor">
<a href="#projected-maps" class="anchor"></a>Projected maps</h3>
<p>The previous example used a map with a geospatial coordinate reference system (CRS) but it was not projected. That map would be ready to view with the <code>leaflet</code> package for example, as would the tiles generated based on it. The next example uses a similar map that is projected. In order to generate map tiles that can be used with <code>leaflet</code> in the standard CRS, the map must be reprojected first. Then the same map tiles are generated as before.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"maps/map_albers.tif"</span>, package <span class="op">=</span> <span class="st">"tiler"</span><span class="op">)</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; class      : RasterLayer </span>
<span class="co">#&gt; dimensions : 32, 71, 2272  (nrow, ncol, ncell)</span>
<span class="co">#&gt; resolution : 85011.74, 103363.8  (x, y)</span>
<span class="co">#&gt; extent     : -2976297, 3059536, -1577300, 1730342  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="co">#&gt; source     : C:/github/tiler/inst/maps/map_albers.tif </span>
<span class="co">#&gt; names      : map_albers </span>
<span class="co">#&gt; values     : -0.593978, 5.544724  (min, max)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="vignette-ex2-1.png" alt=""><p class="caption">plot of chunk ex2</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">map</span>, <span class="va">tile_dir</span>, <span class="st">"0-3"</span><span class="op">)</span>
<span class="co">#&gt; Reprojecting raster...</span>
<span class="co">#&gt; Coloring raster...</span>
<span class="co">#&gt; Preparing for tiling...</span>
<span class="co">#&gt; [1] "C:\\Users\\Matt\\AppData\\Local\\Temp\\RtmpQLDRP8"</span>
<span class="co">#&gt; Creating tiles. Please wait...</span>
<span class="co">#&gt; Creating tile viewer...</span>
<span class="co">#&gt; Complete.</span></code></pre></div>
<p>The tiles generated this time are the same as before, that is, ready for <code>leaflet</code>. <code>tile</code> reprojects the raster layer internally. This can be seen in the log output printed to the console.</p>
</div>
<div id="missing-crs" class="section level3">
<h3 class="hasAnchor">
<a href="#missing-crs" class="anchor"></a>Missing CRS</h3>
<p>If the CRS of the raster is <code>NA</code>, there are two options. By default, <code>tile</code> will fall back on processing the raster layer as if it were a simple image file with no geospatial projection information (see the next section on simple CRS/non-geographic map tiles). These tiles are not the same as the previous sets.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"maps/map_albers_NA.tif"</span>, package <span class="op">=</span> <span class="st">"tiler"</span><span class="op">)</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; class      : RasterLayer </span>
<span class="co">#&gt; dimensions : 32, 71, 2272  (nrow, ncol, ncell)</span>
<span class="co">#&gt; resolution : 85011.74, 103363.8  (x, y)</span>
<span class="co">#&gt; extent     : -2976297, 3059536, -1577300, 1730342  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : NA </span>
<span class="co">#&gt; source     : C:/github/tiler/inst/maps/map_albers_NA.tif </span>
<span class="co">#&gt; names      : map_albers_NA </span>
<span class="co">#&gt; values     : -0.593978, 5.544724  (min, max)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="vignette-ex3-1.png" alt=""><p class="caption">plot of chunk ex3</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">map</span>, <span class="va">tile_dir</span>, <span class="st">"0-3"</span><span class="op">)</span>
<span class="co">#&gt; Warning in .proj_check(file, crs, ...): Projection expected but is missing. Continuing as non-geographic image.</span>
<span class="co">#&gt; Coloring raster...</span>
<span class="co">#&gt; Preparing for tiling...</span>
<span class="co">#&gt; [1] "C:\\Users\\Matt\\AppData\\Local\\Temp\\RtmpQLDRP8"</span>
<span class="co">#&gt; Creating tiles. Please wait...</span>
<span class="co">#&gt; Creating tile viewer...</span>
<span class="co">#&gt; Complete.</span></code></pre></div>
<p>This is not likely what is wanted. The other option is to force set a known CRS if it is missing from the file or was dropped for whatever reason. Now reprojection can proceed and the expected tiles are generated.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs +towgs84=0,0,0"</span>
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">map</span>, <span class="va">tile_dir</span>, <span class="st">"0-3"</span>, <span class="va">crs</span><span class="op">)</span>
<span class="co">#&gt; Reprojecting raster...</span>
<span class="co">#&gt; Coloring raster...</span>
<span class="co">#&gt; Preparing for tiling...</span>
<span class="co">#&gt; [1] "C:\\Users\\Matt\\AppData\\Local\\Temp\\RtmpQLDRP8"</span>
<span class="co">#&gt; Creating tiles. Please wait...</span>
<span class="co">#&gt; Creating tile viewer...</span>
<span class="co">#&gt; Complete.</span></code></pre></div>
<p>A note on reprojection: Depending on the nature of the data in a raster, the <code>...</code> argument to <code>tile</code> allows you to pass through the <code>method</code> argument to <code><a href="https://rdrr.io/pkg/raster/man/projectRaster.html">raster::projectRaster</a></code>. This is <code>bilinear</code> by default for bilinear interpolation, appropriate for continuous data. It can be set to <code>ngb</code> for nearest neighbor, appropriate for discrete or categorical data. If more control is needed over the reprojection, you should just prepare your raster file first before using <code>tile</code>. <code>tiler</code> is not intended to substitute for or wrap general geospatial processing tasks that can easily be done with other packages.</p>
</div>
<div id="coloring-tiles" class="section level3">
<h3 class="hasAnchor">
<a href="#coloring-tiles" class="anchor"></a>Coloring tiles</h3>
<p>Being able to change the default color palette or specify color breaks is important. All other optional <code>...</code> arguments to <code>tile</code> are passed to <code><a href="https://rdrr.io/pkg/raster/man/RGB.html">raster::RGB</a></code> to provide control over the creation of an intermediary RGB raster. Most arguments to <code>RGB</code> can usually be ignored. The most useful ones are <code>col</code> and <code>colNA</code> for the data values color palette and the <code>noData</code> color, respectively. Coloring tiles differently for the original example is as simple as the following.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"maps/map_wgs84.tif"</span>, package <span class="op">=</span> <span class="st">"tiler"</span><span class="op">)</span>
<span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>, <span class="st">"lightblue"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="va">nodata</span> <span class="op">&lt;-</span> <span class="st">"tomato"</span>
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">map</span>, <span class="va">tile_dir</span>, <span class="st">"0-3"</span>, col <span class="op">=</span> <span class="va">pal</span>, colNA <span class="op">=</span> <span class="va">nodata</span><span class="op">)</span>
<span class="co">#&gt; Coloring raster...</span>
<span class="co">#&gt; Preparing for tiling...</span>
<span class="co">#&gt; [1] "C:\\Users\\Matt\\AppData\\Local\\Temp\\RtmpQLDRP8"</span>
<span class="co">#&gt; Creating tiles. Please wait...</span>
<span class="co">#&gt; Creating tile viewer...</span>
<span class="co">#&gt; Complete.</span></code></pre></div>
</div>
<div id="rgb-and-rgba-rasters" class="section level3">
<h3 class="hasAnchor">
<a href="#rgb-and-rgba-rasters" class="anchor"></a>RGB and RGBA rasters</h3>
<p>Multi-band rasters are supported as long as they have three or four layers, in which case <code>tile</code> assumes these represent red, green, blue and alpha channel, respectively. Internally, single-layer raster files are colored and converted to a three- or four-band RGB/A raster object prior to tile generation. If <code>file</code> is already such a raster, this step is simply skipped. Optional arguments like data and <code>noData</code> color, break points, etc., are ignored since this type of raster contains its own color information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"maps/map_albers_rgb.tif"</span>, package <span class="op">=</span> <span class="st">"tiler"</span><span class="op">)</span>
<span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; class      : RasterBrick </span>
<span class="co">#&gt; dimensions : 32, 71, 2272, 3  (nrow, ncol, ncell, nlayers)</span>
<span class="co">#&gt; resolution : 85011.74, 103363.8  (x, y)</span>
<span class="co">#&gt; extent     : -2976297, 3059536, -1577300, 1730342  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs        : +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="co">#&gt; source     : C:/github/tiler/inst/maps/map_albers_rgb.tif </span>
<span class="co">#&gt; names      : map_albers_rgb.1, map_albers_rgb.2, map_albers_rgb.3 </span>
<span class="co">#&gt; min values :                0,                0,                0 </span>
<span class="co">#&gt; max values :              253,              255,              244</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="vignette-ex6-1.png" alt=""><p class="caption">plot of chunk ex6</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">map</span>, <span class="va">tile_dir</span>, <span class="st">"0-3"</span><span class="op">)</span>
<span class="co">#&gt; Reprojecting raster...</span>
<span class="co">#&gt; Preparing for tiling...</span>
<span class="co">#&gt; [1] "C:\\Users\\Matt\\AppData\\Local\\Temp\\RtmpQLDRP8"</span>
<span class="co">#&gt; Creating tiles. Please wait...</span>
<span class="co">#&gt; Creating tile viewer...</span>
<span class="co">#&gt; Complete.</span></code></pre></div>
</div>
</div>
<div id="non-geographic-map-tiles" class="section level2">
<h2 class="hasAnchor">
<a href="#non-geographic-map-tiles" class="anchor"></a>Non-geographic map tiles</h2>
<p>Almost all map tiles you encounter are for geographic maps. They have a geographic coordinate reference system (CRS). Software used to display these map tiles, such as Leaflet, is similarly focused on these kinds of map tiles. Everything is geared towards the dominant use case involving geospatial coordinate systems.</p>
<p>However, there are edge cases where non-geographic maps are required. These can be maps of outer space, game board maps, etc. The base map used to generate map tiles is usually a simple image like a <code>png</code>, <code>jpg</code> or <code>bmp</code> file. The coordinate reference system is a simple Cartesian coordinate system based on the matrix of pixels or grid cells that represent the image.</p>
<p>There is no longitude or latitude or more complex geospatial projection associated with these maps, which is why they are said to have a “simple CRS”. Simple does not necessarily mean easier to work with, however, because geospatial tools, like Leaflet for example, do not cater naturally to non-geographic coordinate systems. Using these map tiles in Leaflet is possible, but takes a bit of non-standard effort.</p>
<div id="basic-example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-example-1" class="anchor"></a>Basic example</h3>
<p>One example was shown previously where a spatial map lacking critical spatial reference information was processed as a simple image. In the example below, this is the intent. Here, the map is a <code>png</code> file. It is a previously saved plot of the Albers-projected US map used in the earlier projected geotiff example. You can see it has a color key legend. As a simple image, all of this will be tiled.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"maps/map.png"</span>, package <span class="op">=</span> <span class="st">"tiler"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plotRGB.html">plotRGB</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="vignette-ex7-1.png" alt=""><p class="caption">plot of chunk ex7</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">map</span>, <span class="va">tile_dir</span>, <span class="st">"0-3"</span><span class="op">)</span>
<span class="co">#&gt; [1] "C:\\Users\\Matt\\AppData\\Local\\Temp\\RtmpQLDRP8"</span>
<span class="co">#&gt; Creating tiles. Please wait...</span>
<span class="co">#&gt; Creating tile viewer...</span>
<span class="co">#&gt; Complete.</span></code></pre></div>
<p>The <code>tile</code> function will automatically process simple image files differently. There is no concept of projection, and coloring tiles is irrelevant because the image file has its own coloring already. Map tiles generated from regular image files can be used with <code>leaflet</code> if done properly. The generated tiles have a simple CRS that is based on the pixel dimensions of the image file. If you were to use these tiles in <code>leaflet</code> for example and you wanted to overlay map markers, you would have to first georeference your locations of interest based on the matrix rows and columns of the image. This is outside the scope of <code>tiler</code>. See the Leaflet JS and <code>leaflet</code> package documentation for details on using simple CRS/non-geographic tiles.</p>
<p>Using a <code>png</code> file is recommended for quality and file size. <code>jpg</code> may yield a lower quality result, while a large, high resolution <code>bmp</code> file may have an enormous file size compared to <code>png</code>.</p>
<p><code>jpg</code> and <code>bmp</code> are <em>optionally</em> supported by <code>tiler</code>. This means they are not installed and imported with <code>tiler</code>. It is assumed the user will provide <code>png</code> images. If using <code>jpg</code> or <code>bmp</code> and the packages <code>jpeg</code> or <code>bmp</code> are not installed, respectively, <code>tile</code> will print a message to the console notifying of the required package installations.</p>
</div>
</div>
<div id="additional-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-arguments" class="anchor"></a>Additional arguments</h2>
<p>Other arguments to <code>tile</code> include <code>format</code>, <code>resume</code>, <code>viewer</code> and <code>georef</code>.</p>
<p><code>format</code> is either <code>xyz</code> (default) or <code>tms</code>. <code>gdal2tiles</code> generates TMS tiles, but XYZ may be more familiar. Tile format only applies to geographic maps. All simple image-based tiles are XYZ format. If setting <code>format = "tms"</code> you may need to do something similar in your Leaflet JavaScript or <code>leaflet</code> package R code for tiles to display with the proper orientation.</p>
<p><code>resume = TRUE</code> simply avoids overwriting tiles by picking up where you left off without changing your set zoom levels and output path.</p>
<p><code>viewer = TRUE</code> creates <code>preview.html</code> adjacent to the <code>tiles</code> directory for previewing tiles in the browser using Leaflet. <code>georef = TRUE</code> adds mouse click feedback to the Leaflet widget. Map markers with matrix index coordinate labels appear on mouse click to assist with georeferencing. <code>georef</code> only applies to non-geographic tiles. This allows for interactive georeferencing of pixels in the image.</p>
<p>Finally, <code>...</code> can pass along some additional arguments. See help documentation for details.</p>
</div>
<div id="serving-map-tiles" class="section level2">
<h2 class="hasAnchor">
<a href="#serving-map-tiles" class="anchor"></a>Serving map tiles</h2>
<p>Map tiles must be served online to be of much use. Serving map tiles is not the purpose of <code>tiler</code> but using your GitHub account is an easy way to do this. Create a GitHub repository, enable GitHub pages for the repository in the repository settings. If the repository is exclusively for serving your map tiles, just set the master branch as the source for your GitHub pages. After committing and pushing your tiles to GitHub, you can access them using a URL of the form</p>
<p><code>https://&lt;your account name&gt;.github.io/maptiles/tiles/{z}/{x}/{y}.png</code></p>
<p>if you store your tiles in a folder named <code>tiles</code> in a repository named <code>maptiles</code> for example.</p>
<p>Here are some <a href="https://github.com/leonawicz/tiles/">examples of non-geographic tile sets</a> hosted on GitHub using Star Trek galaxy maps generated with <code>tiler</code> and here they are used in <a href="https://leonawicz.github.io/rtrek/articles/sc.html">Leaflet maps</a>.</p>
<div id="leaflet-examples-using-remotely-hosted-tiles" class="section level3">
<h3 class="hasAnchor">
<a href="#leaflet-examples-using-remotely-hosted-tiles" class="anchor"></a>Leaflet examples using remotely hosted tiles</h3>
<p>The following two examples use Leaflet to display interactive maps. The maps use remotely hosted map tiles that were created with <code>tiler</code>.</p>
<p>Geographic provider tiles based on the low resolution example map included in <code>tiler</code> of the 48 contiguous US states. These map tiles were originally generated with the following code</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"maps/map_wgs84.tif"</span>, package <span class="op">=</span> <span class="st">"tiler"</span><span class="op">)</span>
<span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="va">file</span>, <span class="st">"tiles"</span>, <span class="st">"0-7"</span><span class="op">)</span></code></pre></div>
<p>and are hosted <a href="https://github.com/leonawicz/tiles/tree/master/us48lr">here</a>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/">leaflet</a></span><span class="op">)</span>
<span class="va">tiles</span> <span class="op">&lt;-</span> <span class="st">"https://leonawicz.github.io/tiles/us48lr/tiles/{z}/{x}/{y}.png"</span>
<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span><span class="op">(</span>
  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leafletOptions</a></span><span class="op">(</span>minZoom <span class="op">=</span> <span class="fl">0</span>, maxZoom <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addProviderTiles.html">addProviderTiles</a></span><span class="op">(</span><span class="st">"Stamen.Toner"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span><span class="op">(</span><span class="va">tiles</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-options.html">tileOptions</a></span><span class="op">(</span>opacity <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-methods.html">setView</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">40</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>Non-geographic provider tiles based on a Star Trek fictional galaxy map. These map tiles were generated with</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tile.html">tile</a></span><span class="op">(</span><span class="st">"st2.png"</span>, <span class="st">"tiles"</span>, <span class="st">"0-7"</span><span class="op">)</span></code></pre></div>
<p>and are hosted <a href="https://github.com/leonawicz/tiles/tree/master/st2">here</a>, including the source file <code>st2.png</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tiles</span> <span class="op">&lt;-</span> <span class="st">"https://leonawicz.github.io/tiles/st2/tiles/{z}/{x}/{y}.png"</span>
<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span><span class="op">(</span>
  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leafletOptions</a></span><span class="op">(</span>
    crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leafletCRS</a></span><span class="op">(</span><span class="st">"L.CRS.Simple"</span><span class="op">)</span>, minZoom <span class="op">=</span> <span class="fl">0</span>, maxZoom <span class="op">=</span> <span class="fl">7</span>, attributionControl <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span><span class="op">(</span><span class="va">tiles</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-methods.html">setView</a></span><span class="op">(</span><span class="fl">71</span>, <span class="op">-</span><span class="fl">60</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>*Note: These hosted tiles were made when <code>tiler</code> made XYZ-format tiles. It now strictly makes TMS tiles. For new tiles in <code>leaflet</code> switch the end of the url from <code>{y}</code> to <code>{-y}</code>.</p>
</div>
<div id="local-preview" class="section level3">
<h3 class="hasAnchor">
<a href="#local-preview" class="anchor"></a>Local preview</h3>
<p>By default <code>tile</code> also creates <code>preview.html</code> as noted above. This can also be created or re-created directly using <code>tile_viewer</code>. In either case, as long as <code>preview.html</code> exists alongside the tiles directory, it can easily be loaded in the browser with <code>view_tiles</code>. See help documentation for details.</p>
<p>If you have tiles in a directory <code>"project/tiles"</code>, creating <code>preview.html</code> directly can be done as follows. The arguments shown are just for illustration.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tile_viewer.html">tile_viewer</a></span><span class="op">(</span><span class="st">"project/tiles"</span>, <span class="st">"3-7"</span><span class="op">)</span> <span class="co"># geographic tiles</span>
<span class="fu"><a href="../reference/tile_viewer.html">tile_viewer</a></span><span class="op">(</span><span class="st">"project/tiles"</span>, <span class="st">"3-7"</span>, width <span class="op">=</span> <span class="fl">1000</span>, height <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="co"># non-geographic tiles</span></code></pre></div>
<p>However the tile preview document is created, it can be viewed by passing the same <code>tiles</code> directory to <code>view_tiles</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/view_tiles.html">view_tiles</a></span><span class="op">(</span><span class="st">"project/tiles"</span><span class="op">)</span></code></pre></div>
</div>
<div id="details" class="section level3">
<h3 class="hasAnchor">
<a href="#details" class="anchor"></a>Details</h3>
<p>The <code>leaflet</code> R code needed in order to use custom non-geographic tiles like these requires setting <code><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leafletOptions(crs = leafletCRS("L.CRS.Simple"))</a></code> as well as calling <code><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles(urlTemplate = url)</a></code> where <code>url</code> is like the example URL shown above. Setting the focus of the map can be a bit tricky for non-geographic map tiles based on an arbitrary image file. It may take some trial and error to get a sense for the custom coordinate system.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/leonawicz">Matthew Leonawicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '449b10b6639e4611f7d5498f30bb2ab2',
    indexName: 'leonawicz_tiler',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
